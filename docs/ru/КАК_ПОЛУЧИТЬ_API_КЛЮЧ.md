# Как получить и настроить API ключ OpenRouter

## Быстрый старт

1. **Регистрация:** https://openrouter.ai/
2. **Создание ключа:** https://openrouter.ai/keys
3. **Пополнение баланса:** https://openrouter.ai/credits
4. **Обновление config.yaml**
5. **Проверка:** `bin\test_api_key.bat`
6. **Запуск:** `bin\start_web.bat`

## Подробная инструкция

### 1. Регистрация на OpenRouter

1. Откройте https://openrouter.ai/
2. Нажмите "Sign Up" или "Get Started"
3. Войдите через:
   - Google аккаунт (рекомендуется)
   - GitHub
   - Email

### 2. Создание API ключа

1. После входа откройте: https://openrouter.ai/keys
2. Нажмите кнопку **"Create API Key"**
3. Введите имя ключа (например: "Stock Analyzer")
4. **ВАЖНО:** Скопируйте ключ сразу!
   - Ключ показывается только один раз
   - Начинается с `sk-or-v1-`
   - Длина ~64 символа
5. Сохраните ключ в безопасное место

### 3. Пополнение баланса

1. Откройте: https://openrouter.ai/credits
2. Нажмите **"Add Credits"**
3. Выберите сумму:
   - Минимум: $5
   - Рекомендуется: $10-20
4. Оплатите через:
   - Банковская карта
   - PayPal
   - Crypto

**Стоимость использования:**
- 1 анализ акции (3 модели): $0.01-0.02
- 10 акций: $0.10-0.20
- 100 акций: $1.00-2.00

### 4. Настройка в проекте

#### Вариант 1: Через текстовый редактор

1. Откройте файл `config.yaml`
2. Найдите строку:
   ```yaml
   api_key: "sk-or-v1-старый-ключ"
   ```
3. Замените на свой ключ:
   ```yaml
   api_key: "sk-or-v1-ваш-новый-ключ"
   ```
4. Сохраните файл (Ctrl+S)

#### Вариант 2: Полный пример config.yaml

```yaml
# OpenRouter API конфигурация
openrouter:
  api_key: "sk-or-v1-abc123def456ghi789jkl012mno345pqr678stu901vwx234yz"
  base_url: "https://openrouter.ai/api/v1"
```

**Важно:**
- Ключ в кавычках
- Без пробелов в начале/конце
- Сохранить в UTF-8

### 5. Проверка ключа

Запустите проверку:
```bash
bin\test_api_key.bat
```

Должно быть:
```
✅ API КЛЮЧ РАБОТАЕТ!
```

Если ошибка:
```
❌ API КЛЮЧ НЕДЕЙСТВИТЕЛЕН!
```

Проверьте:
- Ключ скопирован полностью
- Нет лишних пробелов
- Файл сохранен
- Баланс не нулевой

### 6. Запуск приложения

Всё готово! Запускайте:
```bash
bin\start_web.bat
```

## Управление ключами

### Создание нескольких ключей

Можно создать несколько ключей:
- Один для разработки
- Один для продакшна
- Один для тестов

### Удаление ключа

1. Откройте https://openrouter.ai/keys
2. Найдите ключ
3. Нажмите "Delete"
4. Подтвердите удаление

**Важно:** Удаленный ключ перестанет работать немедленно!

### Просмотр использования

1. Откройте https://openrouter.ai/activity
2. Увидите:
   - Сколько запросов сделано
   - Сколько потрачено средств
   - Какие модели использовались

## Безопасность

### ✅ Правильно:
- Хранить ключ в config.yaml (который в .gitignore)
- Не коммитить config.yaml в Git
- Создать отдельный ключ для каждого проекта
- Регулярно проверять использование

### ❌ Неправильно:
- Публиковать ключ в интернете
- Коммитить config.yaml в публичный репозиторий
- Передавать ключ другим людям
- Использовать один ключ везде

## Проблемы и решения

### Проблема: "User not found" (401)

**Причина:** Ключ недействителен

**Решение:**
1. Проверьте https://openrouter.ai/keys
2. Создайте новый ключ
3. Обновите config.yaml

### Проблема: "Insufficient credits" (402)

**Причина:** Баланс исчерпан

**Решение:**
1. Откройте https://openrouter.ai/credits
2. Пополните баланс ($5-10)

### Проблема: "Rate limit exceeded" (429)

**Причина:** Слишком много запросов

**Решение:**
1. Подождите 1-2 минуты
2. Или пополните баланс (выше лимиты)

### Проблема: Ключ не копируется полностью

**Решение:**
1. Используйте кнопку "Copy" на сайте
2. Или выделите весь ключ мышью
3. Убедитесь, что скопировали от `sk-or-v1-` до конца

## Альтернативы

Если OpenRouter не подходит:

### OpenAI напрямую
- Сайт: https://platform.openai.com/
- Только GPT модели
- Может быть дороже

### Anthropic Claude
- Сайт: https://console.anthropic.com/
- Только Claude модели
- Требует отдельной регистрации

### Google Gemini
- Сайт: https://makersuite.google.com/
- Только Gemini модели
- Есть бесплатный лимит

**Но OpenRouter удобнее:**
- Один ключ для всех моделей
- Единый интерфейс
- Гибкие тарифы

## Полезные ссылки

- Главная: https://openrouter.ai/
- API ключи: https://openrouter.ai/keys
- Баланс: https://openrouter.ai/credits
- Использование: https://openrouter.ai/activity
- Документация: https://openrouter.ai/docs
- Цены: https://openrouter.ai/models

## Поддержка

Если нужна помощь:
1. Email: support@openrouter.ai
2. Discord: https://discord.gg/openrouter
3. Документация: https://openrouter.ai/docs

---

**Всё настроено? Запускайте:** `bin\start_web.bat`
