# Исправлено: Деление на ноль

## Проблема
При экспорте результатов анализа возникала ошибка:
```
ZeroDivisionError: division by zero
```

## Причина
Код пытался делить на количество элементов в пустых списках.

## Что исправлено ✅

### 3 файла, 7 исправлений:

1. **`src/excel_exporter.py`** (2 места)
   - Проверка пустого списка качества перед экспортом
   - Проверка списка уверенности перед расчетом среднего

2. **`src/data_loader.py`** (1 место)
   - Проверка количества акций перед расчетом средней цены и изменения

3. **`src/dashboards/overview.py`** (4 места)
   - Проверка списка предсказаний перед расчетом консенсуса
   - Проверка количества акций перед расчетом процентов
   - Проверка перед расчетом среднего согласия
   - Проверка перед расчетом средних значений

## Решение

Добавлены проверки перед делением:
```python
# Теперь везде используется безопасное деление:
result = sum(data) / len(data) if len(data) > 0 else 0

# Или с ранним возвратом:
if not data:
    return default_value
```

## Результат

Приложение теперь корректно работает с:
- ✅ Пустыми результатами анализа
- ✅ Отсутствующими данными
- ✅ Нулевым количеством акций
- ✅ Пустыми списками предсказаний

Вместо ошибки показывается:
- `"Нет данных"` в Excel
- `"Н/Д"` в веб-интерфейсе
- `0` для числовых значений

## Использование

Просто запустите приложение как обычно:
```bash
bin\start_web.bat
```

Даже если нет результатов анализа, ошибки больше не будет!

---

**Дата:** 2026-02-04  
**Подробности:** См. `BUGFIX_DIVISION_BY_ZERO.md` в корне проекта
